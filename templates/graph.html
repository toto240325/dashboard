<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>My Title</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1"></script>

    <script
        src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@2.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>


    <!-- <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8"></script>
    <script src="path/to/chartjs-plugin-zoom/dist/chartjs-plugin-zoom.min.js"></script> -->


    <!-- <script
        src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script> -->


    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-zoom/1.2.1/chartjs-plugin-zoom.min.js"></script>

    <style type="text/css">
        .chartBox {
            width: 400px;
        }
    </style>
</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Navbar</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="/about">About</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            Dropdown
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="/">Home</a></li>
                            <li><a class="dropdown-item" href="/about">About</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#">Something else here</a></li>
                        </ul>
                    </li>
                    <!-- <li class="nav-item">
                        <a class="nav-link disabled">Disabled</a>
                    </li> -->
                </ul>
                <form class="d-flex">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                    <button class="btn btn-outline-success" type="submit">Search</button>
                </form>
            </div>
        </div>
    </nav>

    <!-- <script type="module">
        import { Chart } from 'chart.js';
        import zoomPlugin from 'chartjs-plugin-zoom';

        Chart.register(zoomPlugin);

    </script> -->
    <script>
        'use strict';
        setTimeout(function () {
            window.location.reload(1);
        }, 10 * 60 * 1000);

        function enable_deletion(mycanvas, mychart) {
            // console.log('Item: %o', mycanvas);
            mycanvas.onclick = function (evt) {
                // console.log("------------------");
                // console.log('mychart: %o', mychart);
                // console.log('mychart: %o', mychart);
                var activePoints = mychart.getElementsAtEventForMode(evt, 'index', { intersect: true }, false);
                var obj = activePoints;
                // console.log('Item: %o', obj);

                if (activePoints[0]) {
                    // console.log("start");
                    var obj = activePoints[0];
                    // console.log('activePoints[0]: %o', activePoints[0]);
                    var index = activePoints[0].index;
                    // console.log('index: %o', index);

                    var chart = mychart.$context.chart;
                    // console.log('chart: %o', chart);
                    var datasets = chart.config._config.data.datasets;
                    // console.log('datasets: %o', datasets);

                    var mydatetime = datasets[0].data[index].x;
                    var value = datasets[0].data[index].y;
                    var id = datasets[1].data[index].y;
                    // console.log('mydatetime: %o', mydatetime);
                    // console.log('value: %o', value);
                    // console.log('id: %o', id);g


                    var url = "http://192.168.0.73/event/api/event/delete.php?id=" + id;
                    if (confirm("sure to want to delete point (value:" + value + ", date:" + mydatetime + ", id:" + id + ") ?")) {
                        console.log("going to delete point");
                        const Http = new XMLHttpRequest();
                        Http.open("GET", url);
                        Http.send();
                        Http.onreadystatechange = (e) => {
                            console.log(Http.responseText)
                        }
                        console.log("popping index %i", index);
                        console.log('before : datasets[0].data : %', datasets[0].data);
                        var spliced = mychart.data.datasets[0].data.splice(index,1);

                        // datasets[0].data.pop(index);
                        console.log('after : datasets[0].data : %', datasets[0].data);
                        mychart.data.datasets[1].data.pop(index);
                        mychart.update();
                        console.log("chart updated ?");
                    } else {
                        console.log("OK, no deletion this time");
                    }
                }
            }
        };


        var zoom_plugin = {
            pan: {
                enabled: true,
                mode: 'x',
                threshold: 10
            },
            zoom: {
                wheel: {
                    enabled: true,
                    // speed: 0.1,
                    modifierKey: 'shift'
                },
                drag: {
                    enabled: true,
                    modifierKey: 'alt'
                },
                pinch: {
                    enabled: true
                },
                mode: 'x',
            }
        };

        function myConfig(labels, values, chart_type) {
            // var timeFormat = 'yyyy/MM/dd H:mm:ss';
            var timeFormat = 'yyyy/MM/dd';

            var a = [];
            for (i = 0; i < labels.length; i++) {
                b = { x: labels[i], y: values[i] };
                a.push(b);
            }
            var data_array_1a = a;

            var xA = {
                type: "time",
                time: {
                    //     format: timeFormat,
                    //     // unit: 'day',
                    parser: 'yyyy-MM-dd H:m:s'
                    //     tooltipFormat: 'll'
                },
                scaleLabel: {
                    display: true,
                    labelString: 'Date1'
                }
            };
            var yA = {
                scaleLabel: {
                    display: true,
                    labelString: 'value'
                }
            };
            var scales1 = {
                xAxes: xA,
                yAxes: yA
            };

            var options1 = {
                responsive: true,
                title: {
                    display: true,
                    text: "Chart.js Time Scale"
                },
                scales: scales1
            };
            var config1 = {
                //type: "line",
                //type: "bar",
                type: chart_type,
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: "temperature2",
                            data: data_array_1a,
                            fill: false,
                            borderColor: "rgb(75, 192, 192)",
                            lineTension: 0.1
                        }
                    ]
                },
                options: options1
            };
            return config1;
        }

        function myConfig2(title, values, values_unit, labels, chart_type, unit, label) {
            // var timeFormat = 'yyyy/MM/dd H:mm:ss';
            var timeFormat = 'yyyy/MM/dd';
            // var timeFormat = 'H:mm';

            var a = [];
            for (i = 0; i < labels.length; i++) {
                b = { x: labels[i], y: values[i] };
                a.push(b);
            }
            var data_array_1a = a;

            nowStr = (new Date()).toLocaleTimeString("fr-BE", { hour12: false, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' });
            var datetime2 = "LastSync: " + nowStr;

            var xA = {
                type: "time",
                time: {
                    // format: timeFormat,

                    displayFormats: {
                        'millisecond': 'MMM dd',
                        'second': 'MMM dd',
                        'minute': 'H:mm',
                        'hour': 'H:mm',
                        'day': 'dd/MM',
                        'week': 'MMM dd',
                        'month': 'MMM dd',
                        'quarter': 'MMM dd',
                        'year': 'MMM dd',
                    },
                    unit: unit,
                    parser: 'yyyy-MM-dd H:m:s'
                },
                scaleLabel: {
                    display: true,
                    labelString: datetime2
                }
            };
            var yA = {
                scaleLabel: {
                    display: true,
                    labelString: values_unit
                }
            };
            var scales1 = {
                xAxes: xA,
                yAxes: yA
            };

            var options1 = {
                responsive: true,
                title: {
                    display: true,
                    text: title
                },
                scales: scales1,
                plugins: {
                    zoom: zoom_plugin
                }
            };
            var config1 = {
                //type: "line",
                //type: "bar",
                type: chart_type,
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: label,
                            data: data_array_1a,
                            fill: false,
                            borderColor: "rgb(75, 192, 192)",
                            lineTension: 0.1
                        }
                    ]
                },
                options: options1
            };
            return config1;
        }

        function myConfig2_with_ids(title, values, ids, values_unit, labels, chart_type, unit, label) {
            // var timeFormat = 'yyyy/MM/dd H:mm:ss';
            var timeFormat = 'yyyy/MM/dd';
            // var timeFormat = 'H:mm';

            var a = [];
            var b = [];
            for (i = 0; i < labels.length; i++) {
                b = { x: labels[i], y: values[i] };
                a.push(b);
            }
            var data_array_1a = a;

            var a = [];
            var b = [];
            for (i = 0; i < labels.length; i++) {
                b = { x: labels[i], y: ids[i] };
                a.push(b);
            }
            var data_array_2a = a;

            nowStr = (new Date()).toLocaleTimeString("fr-BE", { hour12: false, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' });
            var datetime2 = "LastSync: " + nowStr;

            var xA = {
                type: "time",
                time: {
                    // format: timeFormat,
                    displayFormats: {
                        'millisecond': 'MMM dd',
                        'second': 'MMM dd',
                        'minute': 'H:mm',
                        'hour': 'H:mm',
                        'day': 'dd/MM',
                        'week': 'MMM dd',
                        'month': 'MMM dd',
                        'quarter': 'MMM dd',
                        'year': 'MMM dd',
                    },
                    unit: unit,
                    parser: 'yyyy-MM-dd H:m:s'
                },
                scaleLabel: {
                    display: true,
                    labelString: datetime2
                }
            };
            var yA = {
                scaleLabel: {
                    display: true,
                    labelString: values_unit
                }
            };
            var scales1 = {
                xAxes: xA,
                yAxes: yA
            };

            var options1 = {
                // responsive: true,
                title: {
                    display: true,
                    text: title
                },
                scales: scales1,
                plugins: {
                    zoom: zoom_plugin
                    
                    // {
                    //     pan: {
                    //         enabled: true,
                    //         mode: 'xy',
                    //         threshold: 10
                    //     },
                    //     zoom: {
                    //         wheel: {
                    //             enabled: true,
                    //             modifierKey: 'shift'
                    //         },
                    //         pinch: {
                    //             enabled: true
                    //         },
                    //         mode: 'xy',
                    //     }
                    // }



                }
            };
            var config1 = {
                //type: "line",
                //type: "bar",
                type: chart_type,
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: label,
                            data: data_array_1a,
                            fill: false,
                            borderColor: "rgb(75, 192, 192)",
                            lineTension: 0.1
                        },
                        {
                            label: label,
                            data: data_array_2a,
                            fill: false,
                            borderColor: "rgb(75, 192, 192)",
                            hidden: true
                        }
                    ]
                },
                options: options1
            };
            return config1;
        }

        function myConfig_2_datasets(
            title,
            labels1, values1, chart_type1,
            labels2, values2, chart_type2,
            unit) {
            // var timeFormat = 'yyyy/MM/dd H:mm:ss';
            var timeFormat = 'yyyy/MM/dd';

            var data1 = [];
            for (i = 0; i < labels1.length; i++) {
                b = { x: labels1[i], y: values1[i] };
                data1.push(b);
            }

            var data2 = [];
            for (i = 0; i < labels2.length; i++) {
                b = { x: labels2[i], y: values2[i] };
                data2.push(b);
            }

            var xA = {
                id: "bubble",
                type: "time",
                time: {
                    unit: unit,
                    // format: timeFormat,
                    displayFormats: {
                        day: "DD"
                    },
                    parser: 'yyyy-MM-dd H:m:s'
                },
                offset: true,
                type: "category",
                distribution: "series",

                // gridLines: {
                //     offsetGridLines: false,
                //     drawTicks: true,
                //     display: true
                // },
                //stacked: true
            };
            // {
            //     id: "bar",
            //     offset: true,
            //     type: "time",
            //     type: "category",
            //     distribution: "series",
            // }


            var yA = {
                ticks: {
                    beginAtZero: true,
                },
                scaleLabel: {
                    display: true,
                    labelString: 'value'
                }
            };
            // {
            //     id: 'ps4_5min',
            //     scaleLabel: {
            //         display: true,
            //         labelString: 'value'
            //     }
            // }

            var scales1 = {
                xAxes: xA,
                yAxes: yA
            };

            var options = {
                scales: scales1,
                // responsive: true,
                // legend: {
                //     position: 'top',
                // },
                // title:      {
                //     display: true,
                //     text:    title
                // },
                // elements: {
                //     rectangle: {
                //         borderWidth: 2,
                //         borderColor: 'rgb(0, 255, 0)',
                //         borderSkipped: 'bottom'
                //     }
                // }
            };
            //console.log(options);
            var config = {
                //type: "line",
                type: "bar",
                data: {
                    labels: labels2,
                    datasets: [
                        {
                            barPercentage: .7,
                            //     // categoryPercentage: .5,
                            //     //type: chart_type2,
                            xAxisID: "bar",
                            yAxisID: 'ps4_5min',
                            label: "ps4 x5min",
                            data: data2,
                            backgroundColor: "green",
                            borderColor: "black",
                            borderWidth: 1,
                            width: 55,
                            order: 2
                            //     // fill: false
                            //     //lineTension: 0.1
                        },
                        {
                            label: "ps4 up/down",
                            type: chart_type1,
                            data: data1,
                            xAxisID: "bubble",
                            backgroundColor: "orange",
                            borderColor: "orange",
                            fill: false,
                            //lineTension: 0.1,
                            order: 1,
                        }
                    ]
                },
                options: options,
            };
            // console.log(config);
            return config;
        }

        function myConfig_2_datasets2(
            title,
            labels1, values1, chart_type1,
            labels2, values2, chart_type2,
            unit) {
            var timeFormat = 'yyyy/MM/dd';

            var data1 = [];
            for (i = 0; i < labels1.length; i++) {
                b = { x: labels1[i], y: values1[i] };
                data1.push(b);
            }

            var data2 = [];
            // for (i = 0; i < labels2.length; i++) {
            //     b = { x: labels2[i], y: values2[i] };
            //     data2.push(b);
            // }

            var xA = {
                id: "xAxis_ID1",
                type: "time",
                time: {
                    unit: unit,
                    // format: timeFormat,
                    displayFormats: {
                        day: "DD"
                    },
                    parser: 'yyyy-MM-dd H:m:s'
                },
                offset: true,
                type: "category",
                distribution: "series",

                // gridLines: {
                //     offsetGridLines: false,
                //     drawTicks: true,
                //     display: true
                // },
                //stacked: true
            };
            // ,
            // {
            //     id: "night_ID",
            //     offset: true,
            //     type: "time",
            //     type: "category",
            //     distribution: "series",
            // }

            var yA = {
                ticks: {
                    beginAtZero: true,
                },
                scaleLabel: {
                    display: true,
                    labelString: 'Y1'
                }
            };
            var scales1 = {
                xAxes: xA,
                yAxes: yA
            };

            var options = {
                scales: scales1,
                responsive: true,
                // legend: {
                //     position: 'top',
                // },
                title: {
                    display: true,
                    text: title
                },
                // elements: {
                //     rectangle: {
                //         borderWidth: 2,
                //         borderColor: 'rgb(0, 255, 0)',
                //         borderSkipped: 'bottom'
                //     }
                // }
            };
            //console.log(options);
            var config = {
                type: "line",
                data: {
                    labels: labels2,
                    datasets: [
                        {
                            label: "Delta Day",
                            // barPercentage: .7,
                            //     // categoryPercentage: .5,
                            //     //type: chart_type2,
                            // xAxisID: "xAxis_ID",
                            // yAxisID: 'yAxis_ID',
                            // label: "my label",
                            // backgroundColor: "green",
                            borderColor: "green",
                            // borderWidth: 1,
                            // // width: 55,
                            order: 1,
                            //     // fill: false,
                            //     //lineTension: 0.1,
                            data: data1
                        },
                        {
                            label: "Delta Night",
                            // type: "line",
                            // xAxisID: "xAxis_ID2",
                            borderColor: "orange",
                            // backgroundColor: "orange",
                            // borderColor: "orange",
                            // // fill: false,
                            // //lineTension: 0.1,
                            order: 2,
                            data: data2
                        }
                    ]
                },
                options: options,
            };
            // console.log(config);
            return config;
        }

    </script>

    <!-- <canvas id="myCanvas" width="200" height="100" style="border:1px solid #d3d3d3;">
        Your browser does not support the HTML canvas tag.</canvas>

    <script>
        var c = document.getElementById("myCanvas");
        var ctx = c.getContext("2d");
        ctx.moveTo(0, 0);
        ctx.lineTo(200, 100);
        ctx.stroke();
    </script> -->

    <canvas id="canvas32"></canvas>
    <button type="button" onclick="alert('Hello world!')">Click Me!</button>

    <script>

        values = JSON.parse('{{ frigo_1h_chart.values | tojson }}');
        //console.log(values);
        values_unit = "{{ frigo_1h_chart.values_unit|safe }}"
        labels = JSON.parse('{{ frigo_1h_chart.labels | tojson }}');
        title = "{{ frigo_1h_chart.title|safe }}"
        chart_type = "{{ frigo_1h_chart.chart_type|safe }}"
        unit = "{{ frigo_1h_chart.unit|safe }}"
        label = "{{ frigo_1h_chart.label|safe }}"

        var a = [];
        for (i = 0; i < labels.length; i++) {
            b = { x: labels[i], y: values[i] };
            a.push(b);
            // console.log(b);
        }
        data32 = a;

        // var timeFormat = 'dd/MM/yyyy';
        var timeFormat = 'yyyy-MM-dd hh:mm:ss';
        var data31 = [{
            x: "04/01/2014", y: 175
        }, {
            x: "10/01/2014", y: 175
        }, {
            x: "04/01/2015", y: 178
        }, {
            x: "10/01/2015", y: 178
        }];
        var chart_data32 = {
            datasets: [
                {
                    label: "US Dates",
                    // data: data31,
                    data: data32,
                    fill: false,
                    borderColor: 'red'
                },
                {
                    label: "UK Dates2 ",
                    data: data32,
                    fill: false,
                    borderColor: 'blue'
                }
            ]
        };
        // console.log(data3);
        var options32 = {
            responsive: true,
            title: {
                display: true,
                text: "canvas32"
            },
            scales: {
                xAxes: {
                    type: "time",

                    time: {
                        // format: timeFormat,

                        displayFormats: {
                            'millisecond': 'MMM dd',
                            'second': 'MMM dd',
                            'minute': 'H:mm',
                            'hour': 'H:mm',
                            'day': 'dd/MM',
                            'week': 'MMM dd',
                            'month': 'MMM dd',
                            'quarter': 'MMM dd',
                            'year': 'MMM dd',
                        },
                        unit: unit,
                        parser: 'yyyy-MM-dd H:m:s'
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'Date3'
                    }
                },
                yAxes: {
                    scaleLabel: {
                        display: true,
                        labelString: 'value'
                    }
                }
            }
        };
        var config32 = {
            type: 'line',
            data: chart_data32,
            options: options32
            // options: {}
        };

        const myChart32 = new Chart(
            document.getElementById('canvas32'),
            config32
        );

        // var mycanvas32 = document.getElementById("canvas32");
        // mycanvas32.onclick = function (evt) {
        //     var activePoints = myChart32.getElementsAtEvent(evt);
        //     if (activePoints[0]) {
        //         console.log("start");
        //         obj = activePoints[0];
        //         console.log('Item: %o', obj);
        //         var chartData = activePoints[0]['_chart'].config.data;
        //         console.log('chartData: %o', chartData);
        //         var idx = activePoints[0]['_index'];
        //         console.log('idx: %o', idx);
        //         var label = chartData.labels[idx];
        //         console.log('label: %o', label);
        //         var value = chartData.datasets[0].data[idx];
        //         console.log('value: %o', value);

        //         var url = "http://example.com/?label=" + label + "&value=" + value;
        //         // console.log(url);
        //         // alert(url);
        //     }
        // };
    </script>

    <canvas id="canvas_frigo_with_smart" width="900" height="200" style="border:1px solid #d3d3d3;"></canvas>

    <script>
        values = JSON.parse('{{ frigo_1h_chart.values | tojson }}');
        //console.log(values);
        values_unit = "{{ frigo_1h_chart.values_unit|safe }}"
        labels = JSON.parse('{{ frigo_1h_chart.labels | tojson }}');
        title = "{{ frigo_1h_chart.title|safe }}"
        chart_type = "{{ frigo_1h_chart.chart_type|safe }}"
        unit = "{{ frigo_1h_chart.unit|safe }}"
        label = "{{ frigo_1h_chart.label|safe }}"

        var a = [];
        for (i = 0; i < labels.length; i++) {
            b = { x: labels[i], y: values[i] };
            a.push(b);
            // console.log(b);
        }
        data_normal = a;

        values_smart = JSON.parse('{{ frigo_1h_smart_chart.values | tojson }}');
        labels_smart = JSON.parse('{{ frigo_1h_smart_chart.labels | tojson }}');
        values_unit_smart = "{{ frigo_1h_smart_chart.values_unit|safe }}"
        title_smart = "{{ frigo_1h_smart_chart.title|safe }}"
        chart_type_smart = "{{ frigo_1h_smart_chart.chart_type|safe }}"
        unit_smart = "{{ frigo_1h_smart_chart.unit|safe }}"
        label_smart = "{{ frigo_1h_smart_chart.label|safe }}"

        var a = [];
        for (i = 0; i < labels_smart.length; i++) {
            b = { x: labels_smart[i], y: values_smart[i] };
            a.push(b);
        }
        data_smart = a;
        var timeFormat = 'yyyy-MM-dd hh:mm:ss';




        nowStr = (new Date()).toLocaleTimeString("fr-BE", { hour12: false, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' });
        var datetime2 = "LastSync: " + nowStr;

        var xA = {
            type: "time",
            time: {
                // format: timeFormat,

                displayFormats: {
                    'millisecond': 'MMM dd',
                    'second': 'MMM dd',
                    'minute': 'H:mm',
                    'hour': 'H:mm',
                    'day': 'dd/MM',
                    'week': 'MMM dd',
                    'month': 'MMM dd',
                    'quarter': 'MMM dd',
                    'year': 'MMM dd',
                },
                unit: unit,
                parser: 'yyyy-MM-dd H:m:s'
            },
            scaleLabel: {
                display: true,
                labelString: datetime2
            }
        };
        var yA = {
            scaleLabel: {
                display: true,
                labelString: values_unit
            }
        };
        var scales1 = {
            xAxes: xA,
            yAxes: yA
        };


        var config1 = {
            //type: "line",
            //type: "bar",
            type: chart_type,
            data: {
                labels: labels,    //{{ labels | safe }},
                datasets: [
                    {
                        label: label,
                        data: [],
                        fill: false,
                        borderColor: "rgb(75, 192, 192)",
                        lineTension: 0.1
                    }
                ]
            },
            options: options1
        };

        var data_frigo_normal_smart = {
            datasets: [
                {
                    label: "Normal",
                    data: data_normal,
                    fill: false,
                    borderColor: 'red'
                },
                {
                    label: "Smart",
                    data: data_smart,
                    fill: false,
                    borderColor: 'blue'
                }
            ]
        };
        // console.log(data3);


        var options1 = {
            title: {
                display: true,
                text: "Frigo 1h normal vs. smart"
            },
            scales: scales1
        };

        var options_frigo_normal_smart = {
            title: {
                display: true,
                text: "Frigo 1h normal vs. smart"
            },
            scales: {
                xAxes: {
                    type: "time",
                    time: {
                        format: timeFormat
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'Date3'
                    }
                },
                yAxes: {
                    scaleLabel: {
                        display: true,
                        labelString: 'value'
                    }
                }
            }
        };
        var config_frigo_normal_smart = {
            type: 'line',
            data: data_frigo_normal_smart,
            // options: options_frigo_normal_smart
            options: options1
        };


        new Chart(
            document.getElementById('canvas_frigo_with_smart'),
            config_frigo_normal_smart
        );
    </script>


    <!-- <canvas id="canvas_frigo_1h" width="900" height="400" style="border:1px solid #d3d3d3;"></canvas>
    <script>
        // values = {{ frigo_1h_chart.values | safe }}
        values = JSON.parse('{{ frigo_1h_chart.values | tojson }}');
        values_unit = "{{ frigo_1h_chart.values_unit|safe }}"
        // labels = {{ frigo_1h_chart.labels | safe }}
        labels = JSON.parse('{{ frigo_1h_chart.labels | tojson }}');
        title = "{{ frigo_1h_chart.title|safe }}"
        chart_type = "{{ frigo_1h_chart.chart_type|safe }}"
        unit = "{{ frigo_1h_chart.unit|safe }}"
        label = "{{ frigo_1h_chart.label|safe }}"

        config = myConfig2(title, values, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_frigo_1h").getContext("2d");
        // ctx.font = "30px Arial";
        // ctx.fillText("Hello World", 10, 50);
        var lineChart = new Chart(ctx, config);
    </script>

    <canvas id="canvas_frigo_smart_1h" width="900" height="400"></canvas>
    <script>
        // values = {{ frigo_1h_smart_chart.values | safe }}
        values = JSON.parse('{{ frigo_1h_smart_chart.values | tojson }}');
        labels = JSON.parse('{{ frigo_1h_smart_chart.labels | tojson }}');
        values_unit = "{{ frigo_1h_smart_chart.values_unit|safe }}"
        // labels = {{ frigo_1h_smart_chart.labels | safe }}
        title = "{{ frigo_1h_smart_chart.title|safe }}"
        chart_type = "{{ frigo_1h_smart_chart.chart_type|safe }}"
        unit = "{{ frigo_1h_smart_chart.unit|safe }}"
        label = "{{ frigo_1h_smart_chart.label|safe }}"

        config = myConfig2(title, values, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_frigo_smart_1h").getContext("2d");
        var lineChart = new Chart(ctx, config);
    </script> -->

    <canvas id="canvas_frigo_10h" width="900" height="200"></canvas>
    <script>
        values = JSON.parse('{{ frigo_10h_chart.values | tojson }}');
        labels = JSON.parse('{{ frigo_10h_chart.labels | tojson }}');
        // values = {{ frigo_10h_chart.values | safe }}
        // labels = {{ frigo_10h_chart.labels | safe }}
        values_unit = "{{ frigo_10h_chart.values_unit | safe }}"
        title = "{{ frigo_10h_chart.title|safe }}"
        chart_type = "{{ frigo_10h_chart.chart_type|safe }}"
        unit = "{{ frigo_10h_chart.unit|safe }}"
        label = "{{ frigo_10h_chart.label|safe }}"

        config = myConfig2(title, values, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_frigo_10h").getContext("2d");
        var lineChart_frigo_10h = new Chart(ctx, config);

        // allows to swipe up and down on smartPhone/touchScreen
        lineChart_frigo_10h.canvas.style.touchAction = "pan-y";

    </script>

    <canvas id="canvas_frigo_24h" width="900" height="250"></canvas>
    <script>
        values = JSON.parse('{{ frigo_24h_chart.values | tojson }}');
        labels = JSON.parse('{{ frigo_24h_chart.labels | tojson }}');
        // values = {{ frigo_24h_chart.values | safe }}
        // labels = {{ frigo_24h_chart.labels | safe }}
        values_unit = "{{ frigo_24h_chart.values_unit | safe }}"
        title = "{{ frigo_24h_chart.title|safe }}"
        chart_type = "{{ frigo_24h_chart.chart_type|safe }}"
        unit = "{{ frigo_24h_chart.unit|safe }}"
        label = "{{ frigo_24h_chart.label|safe }}"

        config = myConfig2(title, values, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_frigo_24h").getContext("2d");
        var lineChart_frigo_24h = new Chart(ctx, config);

        // allows to swipe up and down on smartPhone/touchScreen
        lineChart_frigo_24h.canvas.style.touchAction = "pan-y";

    </script>

    <canvas id="canvas_pool_ph" width="900" height="300"></canvas>
    <script>

        values = JSON.parse('{{ pool_ph_chart.values | tojson }}');
        var ids = JSON.parse('{{ pool_ph_chart.ids | tojson }}');
        labels = JSON.parse('{{ pool_ph_chart.labels | tojson }}');

        // values = {{ pool_ph_chart.values | safe }}
        // labels = {{ pool_ph_chart.labels | safe }}
        values_unit = "{{ pool_ph_chart.values_unit | safe }}"
        title = "{{ pool_ph_chart.title|safe }}"
        chart_type = "{{ pool_ph_chart.chart_type|safe }}"
        unit = "{{ pool_ph_chart.unit|safe }}"
        label = "{{ pool_ph_chart.label|safe }}"

        config = myConfig2_with_ids(title, values, ids, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_pool_ph").getContext("2d");
        var lineChart_pool_ph = new Chart(ctx, config);

        // allows to swipe up and down on smartPhone/touchScreen
        lineChart_pool_ph.canvas.style.touchAction = "pan-y";

        var canvas_pool_ph = document.getElementById("canvas_pool_ph");
        enable_deletion(canvas_pool_ph, lineChart_pool_ph);

    </script>


    <canvas id="canvas_pool_cl" width="900" height="300"></canvas>
    <script>
        values = JSON.parse('{{ pool_cl_chart.values | tojson }}');
        var ids = JSON.parse('{{ pool_cl_chart.ids | tojson }}');
        labels = JSON.parse('{{ pool_cl_chart.labels | tojson }}');

        // values = {{ pool_cl_chart.values | safe }}
        // labels = {{ pool_cl_chart.labels | safe }}
        values_unit = "{{ pool_cl_chart.values_unit | safe }}"
        title = "{{ pool_cl_chart.title|safe }}"
        chart_type = "{{ pool_cl_chart.chart_type|safe }}"
        unit = "{{ pool_cl_chart.unit|safe }}"
        label = "{{ pool_cl_chart.label|safe }}"

        config = myConfig2_with_ids(title, values, ids, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_pool_cl").getContext("2d");
        var lineChart_pool_cl = new Chart(ctx, config);

        // allows to swipe up and down on smartPhone/touchScreen
        lineChart_pool_cl.canvas.style.touchAction = "pan-y";

        var canvas_pool_cl = document.getElementById("canvas_pool_cl");
        enable_deletion(canvas_pool_cl, lineChart_pool_cl);

    </script>

    <canvas id="canvas_power" width="900" height="250"></canvas>
    <script>
        title = "{{ power_chart.title|safe }}"
        // console.log("title : " + title)

        values1 = JSON.parse('{{ power_chart.values1 | tojson }}');
        labels1 = JSON.parse('{{ power_chart.labels1 | tojson }}');
        // labels1 = {{ power_chart.labels1 | safe }}
        // values1 = {{ power_chart.values1 | safe }}
        chart_type1 = "{{ power_chart.chart_type1|safe }}"

        values2 = JSON.parse('{{ power_chart.values2 | tojson }}');
        labels2 = JSON.parse('{{ power_chart.labels2 | tojson }}');
        // labels2 = {{ power_chart.labels2 | safe }}
        // values2 = {{ power_chart.values2 | safe }}
        chart_type2 = "{{ power_chart.chart_type2|safe }}"

        unit = "{{ power_chart.unit|safe }}"

        config = myConfig_2_datasets2(
            title,
            labels1, values1, chart_type1,
            labels2, values2, chart_type2,
            unit);
        //console.log(config);

        var ctx = document.getElementById("canvas_power").getContext("2d");
        var lineChart = new Chart(ctx, config);
    </script>


    <div style="width:75%;"><canvas id="canvas4"></canvas>
    </div>
    <script>
        const labels4 = [
            'January',
            'February',
            'March',
            'April',
            'May',
            'June',
        ];
        data1 = [0, 10, 5, 2, 20, 30, 45];
        data2 = [5, 15, 15, 22, 21, 30, 40];

        const datafull4 = {
            labels: labels4,
            datasets: [{
                label: 'My second dataset',
                data: data1,
            },
            {
                label: 'My third dataset',
                data: data2,
            }]
        };

        const config4 = {
            type: 'line',
            data: datafull4,
            options: {
                title: {
                    display: true,
                    text: "canvas4"
                }
            }
        };

        const myChart4 = new Chart(
            document.getElementById('canvas4'),
            config4
        );
        // var mycanvas = document.getElementById("canvas4");
        // console.log('Item: %o', mycanvas);
        // mycanvas.onclick = function (evt) {
        //     console.log("--------------------");
        //     console.log('mychart4: %o', myChart4);
        //     var activePoints = myChart4.getElementsAtEvent(evt);
        //     if (activePoints[0]) {
        //         console.log(" activePoints");
        //         obj = activePoints[0];
        //         console.log('Item: %o', obj);
        //         var chartData = activePoints[0]['_chart'].config.data;
        //         console.log('chartData: %o', chartData);
        //         var idx = activePoints[0]['_index'];
        //         console.log('idx: %o', idx);
        //         var label = chartData.labels[idx];
        //         console.log('label: %o', label);
        //         var value = chartData.datasets[0].data[idx];
        //         console.log('value: %o', value);

        //         var url = "http://example.com/?label=" + label + "&value=" + value;
        //         // console.log(url);
        //         // alert(url);
        //     }
        // };

    </script>

    <canvas id="canvas_power_day" width="900" height="300"></canvas>
    <script type="module">
        // alert(import.meta.url); // script URL

        values = JSON.parse('{{ power_day_chart.values | tojson }}');
        var ids = JSON.parse('{{ power_day_chart.ids | tojson }}');
        labels = JSON.parse('{{ power_day_chart.labels | tojson }}');
        values_unit = "{{ power_day_chart.values_unit | safe }}"
        title = "{{ power_day_chart.title|safe }}"
        chart_type = "{{ power_day_chart.chart_type|safe }}"
        unit = "{{ power_day_chart.unit|safe }}"
        label = "{{ power_day_chart.label|safe }}"

        config = myConfig2_with_ids(title, values, ids, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_power_day").getContext("2d");
        var lineChartPowerDay = new Chart(ctx, config);
        var canvas_power_day = document.getElementById("canvas_power_day");
        enable_deletion(canvas_power_day, lineChartPowerDay);


        // import { Chart } from 'chart.js';
        // import { Chart } from './node_modules/chart.js';
        // import Chart from 'https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js';
        // parse = require('https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js');


        // import zoomPlugin from './node_modules/chartjs-plugin-zoom';
        // Chart.register(zoomPlugin);

        // var mycanvasday = document.getElementById("canvas_power_day");
        // // console.log('Item: %o', mycanvasday);
        // mycanvasday.onclick = function (evt) {
        //     console.log("------------------");
        //     console.log('lineChartPowerDay: %o', lineChartPowerDay);
        //     var activePoints = lineChartPowerDay.getElementsAtEventForMode(evt, 'index', { intersect: true }, false);
        //     var obj = activePoints;
        //     console.log('Item: %o', obj);

        //     if (activePoints[0]) {
        //         console.log("start");
        //         obj = activePoints[0];
        //         // console.log('activePoints[0]: %o', activePoints[0]);
        //         var index = activePoints[0].index;
        //         // console.log('index: %o', index);

        //         var chart = lineChartPowerDay.$context.chart;
        //         // console.log('chart: %o', chart);
        //         var datasets = chart.config._config.data.datasets;
        //         // console.log('datasets: %o', datasets);

        //         var mydatetime = datasets[0].data[index].x;
        //         var value = datasets[0].data[index].y;
        //         var id = datasets[1].data[index].y;
        //         console.log('mydatetime: %o', mydatetime);
        //         console.log('value: %o', value);
        //         console.log('id: %o', id);


        //         var url = "http://192.168.0.73/event/api/event/delete.php?id=" + id;
        //         if (confirm("sure to want to delete point (value:" + value + ", date:" + mydatetime + ", id:" + id + ") ?")) {
        //             console.log("going to delete point");
        //             const Http = new XMLHttpRequest();
        //             Http.open("GET", url);
        //             Http.send();
        //             Http.onreadystatechange = (e) => {
        //                 console.log(Http.responseText)
        //             }
        //         } else {
        //             console.log("OK, no deletion this time");
        //         }



        //         // const Http = new XMLHttpRequest();
        //         // Http.open("GET", url);
        //         // Http.send();
        //         // Http.onreadystatechange = (e) => {
        //         //     console.log(Http.responseText)
        //         // }
        //     }
        // };
    </script>

    <canvas id="canvas_power_day_delta" width="900" height="300"></canvas>
    <script>
        values = JSON.parse('{{ power_day_delta_chart.values | tojson }}');
        labels = JSON.parse('{{ power_day_delta_chart.labels | tojson }}');
        // values = {{ power_day_delta_chart.values | safe }}
        // labels = {{ power_day_delta_chart.labels | safe }}"
        values_unit = "{{ power_day_delta_chart.values_unit | safe }}"
        title = "{{ power_day_delta_chart.title|safe }}"
        chart_type = "{{ power_day_delta_chart.chart_type|safe }}"
        unit = "{{ power_day_delta_chart.unit|safe }}"
        label = "{{ power_day_delta_chart.label|safe }}"

        config = myConfig2(title, values, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_power_day_delta").getContext("2d");
        var lineChart_power_day_delta = new Chart(ctx, config);
    </script>


    <canvas id="canvas_power_night" width="900" height="300"></canvas>
    <script>
        console.log("test");
        values = JSON.parse('{{ power_night_chart.values | tojson }}');
        var ids = JSON.parse('{{ power_night_chart.ids | tojson }}');

        // console.log("toto" + values);
        // console.log("toto" + IDs);

        labels = JSON.parse('{{ power_night_chart.labels | tojson }}');
        // values = {{ power_night_chart.values | safe }}
        // labels = {{ power_night_chart.labels | safe }}
        values_unit = "{{ power_night_chart.values_unit | safe }}"
        title = "{{ power_night_chart.title|safe }}"
        chart_type = "{{ power_night_chart.chart_type|safe }}"
        unit = "{{ power_night_chart.unit|safe }}"
        label = "{{ power_night_chart.label|safe }}"

        config = myConfig2_with_ids(title, values, ids, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_power_night").getContext("2d");
        var lineChart_power_night = new Chart(ctx, config);

        var canvas_power_night = document.getElementById("canvas_power_night");
        enable_deletion(canvas_power_night, lineChart_power_night);

        // mycanvas_night.onclick = function (evt) {
        //     console.log("------------------");
        //     console.log('lineChart_power_night: %o', lineChart_power_night);
        //     var activePoints = lineChart_power_night.getElementsAtEventForMode(evt);
        //     if (activePoints[0]) {
        //         var chartData = activePoints[0]['_chart'].config.data;
        //         var idx = activePoints[0]['_index'];
        //         // var label = chartData.labels[idx];
        //         // var value = chartData.datasets[0].data[idx];
        //         var id = chartData.datasets[1].data[idx];

        //         var url = "http://192.168.0.73/event/api/event/delete.php?id=" + id.y;

        //         const Http = new XMLHttpRequest();
        //         Http.open("GET", url);
        //         Http.send();
        //         Http.onreadystatechange = (e) => {
        //             console.log(Http.responseText)
        //         }
        //     }
        // };

    </script>

    <canvas id="canvas_power_night_delta" width="900" height="300"></canvas>
    <script>
        values = JSON.parse('{{ power_night_delta_chart.values | tojson }}');
        labels = JSON.parse('{{ power_night_delta_chart.labels | tojson }}');
        // values = {{ power_night_delta_chart.values | safe }}
        // labels = {{ power_night_delta_chart.labels | safe }}
        values_unit = "{{ power_night_delta_chart.values_unit | safe }}"
        title = "{{ power_night_delta_chart.title|safe }}"
        chart_type = "{{ power_night_delta_chart.chart_type|safe }}"
        unit = "{{ power_night_delta_chart.unit|safe }}"
        label = "{{ power_night_delta_chart.label|safe }}"

        config = myConfig2(title, values, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_power_night_delta").getContext("2d");
        var lineChart = new Chart(ctx, config);
    </script>


    <canvas id="canvas_ps4" width="900" height="300"></canvas>
    <script>
        values = JSON.parse('{{ ps4_chart.values | tojson }}');
        labels = JSON.parse('{{ ps4_chart.labels | tojson }}');
        // values = {{ ps4_chart.values | safe }}
        // labels = {{ ps4_chart.labels | safe }}
        values_unit = "{{ ps4_chart.values_unit|safe }}"
        title = "{{ ps4_chart.title|safe }}"
        chart_type = "{{ ps4_chart.chart_type|safe }}"
        unit = "{{ ps4_chart.unit|safe }}"
        label = "{{ ps4_chart.label|safe }}"

        config = myConfig2(title, values, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_ps4").getContext("2d");
        var lineChart = new Chart(ctx, config);
    </script>

    <canvas id="canvas_ps4_2" width="900" height="300"></canvas>
    <script>
        title = "{{ ps4_chart.title|safe }}"
        values = JSON.parse('{{ ps4_2_chart.values | tojson }}');
        labels = JSON.parse('{{ ps4_2_chart.labels | tojson }}');
        // values = {{ ps4_2_chart.values | safe }}
        // labels = {{ ps4_2_chart.labels | safe }}
        values_unit = "{{ ps4_2_chart.values_unit|safe }}"
        chart_type = "{{ ps4_2_chart.chart_type|safe }}"
        unit = "{{ ps4_chart.unit|safe }}"
        label = "{{ ps4_chart.label|safe }}"

        config = myConfig2(title, values, values_unit, labels, chart_type, unit, label);

        var ctx = document.getElementById("canvas_ps4_2").getContext("2d");
        var lineChart = new Chart(ctx, config);
    </script>

    <canvas id="canvas_bar" width="900" height="300"></canvas>
    <script>
        var barChartData = {
            labels: ["2015-01-01", "2015-02-01", "2015-03-01", "2015-04-01", "2015-05-01", "2015-07-01"],
            datasets: [{/*from  w w w  . de mo 2 s . com*/
                categoryPercentage: .5,
                barPercentage: 1,
                label: 'Dataset 1',
                backgroundColor: "rgba(220,220,220,0.5)",
                data: [10, 4, 5, 7, 2, 3]
            }]
        };
        var ctx = document.getElementById("canvas_bar").getContext("2d");
        var my_bar_chart = new Chart(ctx, {
            type: 'bar',
            data: barChartData,
            options: {
                elements: {
                    rectangle: {
                        borderWidth: 2,
                        borderColor: 'rgb(0, 255, 0)',
                        borderSkipped: 'bottom'
                    }
                },
                responsive: true,
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: 'Chart.js Bar Chart'
                },
                scales: {
                    xAxes: {
                        type: 'time',
                        offset: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Year-Month'
                        },
                        time: {
                            // min: '2014-12-01' ,
                            // max: '2015-12-01',
                            unit: 'month',
                            displayFormats: {
                                month: "MMM yy"
                            }
                        },
                        gridLines: {
                            offsetGridLines: false,
                            drawTicks: true,
                            display: true
                        },
                        stacked: true
                    },
                    yAxes: {
                        ticks: {
                            beginAtZero: true
                        },
                        stacked: true
                    }
                }
            }
        });

        var canvas_bar = document.getElementById("canvas_bar");
        canvas_bar.onclick = function (evt) {
            index = 2;
            console.log("my_bar_chart : %o", my_bar_chart);
            console.log("my_bar_chart.data: %o", my_bar_chart.data);
            alert("test");
            console.log("popping index %i", index);
            console.log("popping element with value %i and label %s", my_bar_chart.data.datasets[0].data[index],my_bar_chart.data.datasets[0].label[index]);
            console.log('before : datasets[0].data : %', my_bar_chart.data.datasets[0].data);
            //console.log("popped : %o", my_bar_chart.data.datasets[0].data.pop(index));
            console.log("splicing");
            var spliced = my_bar_chart.data.datasets[0].data.splice(index,1);
            var spliced = my_bar_chart.data.labels.splice(index,1);
            console.log("index : %o", index);


            // datasets[0].data.pop(index);
            console.log('after : datasets[0].data : %', my_bar_chart.data.datasets[0].data);
            my_bar_chart.update();
            console.log("chart updated ?");
        };

    </script>

    <canvas id="canvas_bar2" width="900" height="300"></canvas>
    <script>
        const dailyStock = [
            { x: "2017-07-25", y: 1 },
            { x: "2017-08-25", y: 3 },
            { x: "2017-09-10", y: 7 },
            { x: "2017-09-28", y: 0 },
            { x: "2017-10-02", y: 3 },
            { x: "2017-10-24", y: 2 },
            { x: "2017-12-01", y: 1 },
            { x: "2017-12-30", y: 0 },
        ];

        const monthlyTotal = [
            { x: "2017-08-01", y: 1 },
            { x: "2017-09-01", y: 10 },
            { x: "2017-10-01", y: 5 },
            { x: "2017-12-01", y: 6 },
        ];

        var ctx = document.getElementById("canvas_bar2").getContext("2d");
        var myChart = new Chart(ctx, {
            type: "bar",
            data: {
                //labels: ["2017-08", "2017-09", "2017-10", "2017-11", "2017-12"],
                datasets: [
                    {
                        barPercentage: .7,
                        // xAxisID: "bar",
                        // label: "sales",
                        data: monthlyTotal,
                        // backgroundColor: "green",
                        // borderColor: "black",
                        // borderWidth: 1,
                        // width: 55,
                        // order: 2,
                    },
                    {
                        label: "stock",
                        type: "line",
                        data: dailyStock,
                        backgroundColor: "orange",
                        borderColor: "orange",
                        fill: false,
                        order: 1,
                    },
                ],
            },
            options: {
                scales: {
                    xAxes: {
                        // id: "line",
                        type: "time",
                        // time: {
                        //     unit: "month",
                        //     displayFormats: {
                        //         month: "MMM",
                        //     },
                        // },
                        // distribution: "linear",
                    },
                    // {
                    //     id: "bar",
                    //     offset: true,
                    //     type: "category",
                    //     distribution: "series",
                    // }
                    yAxes: {
                        ticks: {
                            beginAtZero: true,
                        },
                    },
                },
            },
        });
    </script>


    <canvas id="canvas_bar3" width="900" height="300"></canvas>
    <script>
        const dailyStock2 = [
            { x: "2017-08-02 10:00", y: 1 },
            { x: "2017-08-02 11:00", y: 3 },
            { x: "2017-08-02 15:00", y: 7 },
            { x: "2017-08-03 09:00", y: 0 },
            { x: "2017-08-03 10:00", y: 3 },
            { x: "2017-08-03 10:30", y: 2 },
            { x: "2017-08-04 10:45", y: 1 },
            { x: "2017-08-10 17:00", y: 0 },
        ];

        const monthlyTotal2 = [
            { x: "2017-08-02", y: 1 },
            { x: "2017-08-03", y: 10 },
            { x: "2017-08-04", y: 5 },
            { x: "2017-08-10", y: 5 },
        ];

        var ctx2 = document.getElementById("canvas_bar3").getContext("2d");
        var myChart2 = new Chart(ctx2, {
            type: "bar",
            data: {
                labels: ["2017-08-02", "2017-08-03", "2017-08-04", "2017-08-10"],
                datasets: [
                    {
                        barPercentage: .7,
                        xAxisID: "bar",
                        label: "sales",
                        data: monthlyTotal2,
                        backgroundColor: "green",
                        borderColor: "black",
                        borderWidth: 1,
                        width: 55,
                        order: 2,
                    },
                    {
                        label: "stock",
                        type: "line",
                        data: dailyStock2,
                        backgroundColor: "orange",
                        borderColor: "orange",
                        fill: false,
                        order: 1,
                    },
                ],
            },
            options: {
                scales: {
                    xAxes: {
                        id: "line",
                        type: "time",
                        time: {
                            unit: "day",
                            displayFormats: {
                                month: "DD",
                            },
                        },
                        distribution: "linear",
                    },
                    // {
                    //     id: "bar",
                    //     offset: true,
                    //     type: "category",
                    //     distribution: "series",
                    // }
                    yAxes:
                    {
                        ticks: {
                            beginAtZero: true,
                        },
                    },
                },
            },
        });
    </script>


    <canvas id="canvas_ps4_2_datasets" width="900" height="300"></canvas>
    <script>
        title = "{{ ps4_2_datasets_chart.title|safe }}"
        values1 = JSON.parse('{{ ps4_2_datasets_chart.values1 | tojson }}');
        labels1 = JSON.parse('{{ ps4_2_datasets_chart.labels1 | tojson }}');
        // labels1 = {{ ps4_2_datasets_chart.labels1 | safe }}
        // values1 = {{ ps4_2_datasets_chart.values1 | safe }}
        chart_type1 = "{{ ps4_2_datasets_chart.chart_type1|safe }}"

        values2 = JSON.parse('{{ ps4_2_datasets_chart.values2 | tojson }}');
        labels2 = JSON.parse('{{ ps4_2_datasets_chart.labels2 | tojson }}');
        // labels2 = {{ ps4_2_datasets_chart.labels2 | safe }}
        // values2 = {{ ps4_2_datasets_chart.values2 | safe }}
        chart_type2 = "{{ ps4_2_datasets_chart.chart_type2|safe }}"

        unit = "{{ ps4_2_datasets_chart.unit|safe }}"

        config = myConfig_2_datasets(
            title,
            labels1, values1, chart_type1,
            labels2, values2, chart_type2,
            unit);
        //console.log(config);

        var ctx = document.getElementById("canvas_ps4_2_datasets").getContext("2d");
        var lineChart = new Chart(ctx, config);
    </script>

    <canvas id="canvas3"></canvas>
    <script>
        var timeFormat = 'dd/MM/yyyy';
        var data31 = [{
            x: "04/01/2014", y: 175
        }, {
            x: "10/01/2014", y: 175
        }, {
            x: "04/01/2015", y: 178
        }, {
            x: "10/01/2015", y: 178
        }];

        var data3 = {
            datasets: [
                {
                    label: "US Dates",
                    data: data31,
                    fill: false,
                    borderColor: 'red'
                },
                {
                    label: "UK Dates2 ",
                    data: [{
                        x: "01/04/2014", y: 175
                    }, {
                        x: "01/10/2014", y: 175
                    }, {
                        x: "01/04/2015", y: 178
                    }, {
                        x: "01/10/2015", y: 178
                    }],
                    fill: false,
                    borderColor: 'blue'
                }
            ]
        };
        // console.log(data3);
        var options3 = {
            responsive: true,
            title: {
                display: true,
                text: "Chart.js Time Scale"
            },
            scales: {
                xAxes: {
                    type: "time",
                    time: {
                        format: timeFormat,
                        // tooltipFormat: 'll'
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'Date3'
                    }
                },
                yAxes: {
                    scaleLabel: {
                        display: true,
                        labelString: 'value'
                    }
                }
            }
        };
        var config3 = {
            type: 'line',
            data: data3,
            options: options3
            // options: {}
        };

        // -------------------------
        //         const labels3 = [
        //             'January',
        //             'February',
        //             'March',
        //             'April',
        //             'May',
        //             'June',
        //             ];
        //         const data3 = {
        //             labels: labels3,
        //             datasets: [{
        //                 label: 'My First dataset',
        //                 backgroundColor: 'rgb(255, 99, 132)',
        //                 borderColor: 'rgb(255, 99, 132)',
        //                 data: [0, 10, 5, 2, 20, 30, 45],
        //             }]
        //         };
        //         const config3 = {
        //             type: 'line',
        //             data: data3,
        //             options: {}
        //             };

        const myChart3 = new Chart(
            document.getElementById('canvas3'),
            config3
        );

        // var mycanvas3 = document.getElementById("canvas3");
        // mycanvas3.onclick = function (evt) {
        //     var activePoints = myChart3.getElementsAtEvent(evt);
        //     if (activePoints[0]) {
        //         console.log("start");
        //         obj = activePoints[0];
        //         console.log('Item: %o', obj);
        //         var chartData = activePoints[0]['_chart'].config.data;
        //         console.log('chartData: %o', chartData);
        //         var idx = activePoints[0]['_index'];
        //         console.log('idx: %o', idx);
        //         var label = chartData.labels[idx];
        //         console.log('label: %o', label);
        //         var value = chartData.datasets[0].data[idx];
        //         console.log('value: %o', value);

        //         var url = "http://example.com/?label=" + label + "&value=" + value;
        //         // console.log(url);
        //         // alert(url);
        //     }
        // };

    </script>


    <!-- <div style="width:75%;"><canvas id="canvas5"></canvas>
    </div>
    <script>
        data5 = [{ id: 'Sales', value: 1500 }, { id: 'Purchases', value: 500 }, { id: 'Purchases', value: 100 }, { id: 'Purchases', value: 300 }]
        const config5 = {
            type: 'line',
            data: {
                datasets: [{
                    data: data5.map(o => o.value)
                }]
            },
            options: {
                parsing: {
                    xAxisKey: 'id',
                    yAxisKey: 'nested.value'
                }
            }
        };

        const myChart5 = new Chart(
            document.getElementById('canvas5'),
            config5
        );
        var mycanvas = document.getElementById("canvas5");
        console.log('Item: %o', mycanvas);
        mycanvas.onclick = function (evt) {
            console.log("chart5 clicked !");
            console.log('mychart5: %o', myChart4);
            var activePoints = myChart5.getElementsAtEvent(evt);
            if (activePoints[0]) {
                console.log("start");
                obj = activePoints[0];
                console.log('Item: %o', obj);
                var chartData = activePoints[0]['_chart'].config.data;
                console.log('chartData: %o', chartData);
                var idx = activePoints[0]['_index'];
                console.log('idx: %o', idx);
                var label = chartData.labels[idx];
                console.log('label: %o', label);
                var value = chartData.datasets[0].data[idx];
                console.log('value: %o', value);

                var url = "http://example.com/?label=" + label + "&value=" + value;
                // console.log(url);
                // alert(url);
            }
        };

    </script> -->


</body>

</html>